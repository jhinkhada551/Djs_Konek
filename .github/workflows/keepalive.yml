name: Keep site awake

on:
  schedule:
    - cron: '*/5 * * * *' # every 5 minutes
  workflow_dispatch: {}

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping site
        env:
          TARGET: ${{ secrets.KEEPALIVE_URL }}
        run: |
          if [ -z "$TARGET" ]; then
            echo "ERROR: set repository secret KEEPALIVE_URL to the full URL to ping (e.g. https://example.com/health)";
            exit 1;
          fi
          curl -fsS --retry 3 "$TARGET" || true
